function generateCode(length) {
  const code = [];
  for (let i = 0; i < length; i++) {
    code.push(Math.floor(Math.random() * 10));
  }
  return code;
}

function generateGuess(length) {
  const guess = [];
  for (let i = 0; i < length; i++) {
    guess.push(Math.floor(Math.random() * 10));
  }
  return guess;
}

function evaluateGuess(code, guess) {
  let correctPlace = 0;
  let wrongPlace = 0;
  const codeCopy = [...code];
  const guessCopy = [...guess];

  // First pass: correct digits in correct place
  for (let i = 0; i < code.length; i++) {
    if (guess[i] === code[i]) {
      correctPlace++;
      codeCopy[i] = guessCopy[i] = null; // Mark as used
    }
  }

  // Second pass: correct digits in wrong place
  for (let i = 0; i < guess.length; i++) {
    if (guessCopy[i] !== null) {
      const index = codeCopy.indexOf(guessCopy[i]);
      if (index !== -1) {
        wrongPlace++;
        codeCopy[index] = null; // Mark as used
      }
    }
  }

  return { correctPlace, wrongPlace };
}

function generatePuzzle(length = 6, clueCount = 5) {
  const code = generateCode(length);
  const clues = [];

  for (let i = 0; i < clueCount; i++) {
    const guess = generateGuess(length);
    const { correctPlace, wrongPlace } = evaluateGuess(code, guess);
    clues.push({
      guess: guess.join(''),
      correctPlace,
      wrongPlace
    });
  }

  console.log(`🔐 This lock has a ${length}-digit code. Can you crack it using only these hints?\n`);
  clues.forEach((clue, index) => {
    let line = `${clue.guess} → `;
    if (clue.correctPlace > 0) line += `${clue.correctPlace} number(s) correct and in the right place`;
    if (clue.wrongPlace > 0) {
      if (clue.correctPlace > 0) line += `, `;
      line += `${clue.wrongPlace} correct but in the wrong place`;
    }
    if (clue.correctPlace === 0 && clue.wrongPlace === 0) line += `Nothing is correct`;
    console.log(line);
  });

  console.log(`\n(Secret Code: ${code.join('')})`);
}

// Example: generate a 6-digit puzzle
generatePuzzle(6);
